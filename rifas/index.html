<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Venta de Lotería/Rifas</title>
    <style>
body {
    font-family: sans-serif;
    margin: 0;
    padding: 0;
}

header {
    background-color: #f0f0f0;
    padding: 20px;
    text-align: center;
}

h1 {
    margin: 0;
}

.boletos, .compra, .reporte {
    margin: 20px;
    padding: 20px;
    border: 1px solid #ccc;
    border-radius: 5px;
}

.lista-boletos {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
}

.boleto {
    width: 200px;
    height: 100px;
    background-color: #eee;
    border: 1px solid #ccc;
    margin: 10px;
    text-align: center;
    padding: 10px;
    font-size: 16px;
}

.compra form {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.compra label {
    display: block;
    margin-bottom: 5px;
}

.compra input,
.compra select {
    padding: 5px;
    border: 1px solid #ccc;
    border-radius: 5px;
}

.compra button {
    background-color: #4CAF50;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}

.reporte .ventas-dia {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.reporte .venta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 5px;
    border-bottom: 1px solid #ccc;
}

.configuracion {
    margin: 20px;
    padding: 20px;
    border: 1px solid #ccc;
    border-radius: 5px;
}

.configuracion h2 {
    margin-top: 0;
}

.configuracion label {
    display: block;
    margin-bottom: 5px;
}

.configuracion input[type="number"] {
    padding: 5px;
    border: 1px solid #ccc;
    border-radius: 5px;
    width: 100px;
}

.configuracion button {
    background-color: #4CAF50;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}

.configuracion button:hover {
    background-color: #45a049;
}

.configuracion button:active {
    background-color: #3e8e41;
}


    </style>
</head>
<body>
<header>
        <h1>Venta de Lotería/Rifas</h1>
    </header>

    <section class="boletos">
        <h2>Boletos Disponibles</h2>
        <div id="lista-boletos">
            </div>  </section>

    <section class="compra">
        <h2>Comprar Boleto</h2>
        <form id="formulario-compra">
            <label for="nombre">Nombre:</label>
            <input type="text" id="nombre" name="nombre" required>

            <label for="boleto">Número de boleto:</label>
            <select id="boleto" name="boleto" required>
            </select>

            <label for="metodo-pago">Método de pago:</label>
            <select id="metodo-pago" name="metodo-pago" required>
                <option value="efectivo">Efectivo</option>
                <option value="tarjeta">Tarjeta de crédito/débito</option>
            </select>

            <button type="submit">Comprar</button>
        </form>
    </section>

    <section class="reporte">
        <h2>Reporte de Ventas</h2>
        <div class="ventas-dia">
        </div>
        <canvas id="graficaVentas"></canvas></section>
    
        <section class="configuracion">
            <h2>Configuración de Rifas</h2>
            <form id="formulario-configuracion">
                <label for="cantidad-numeros">Cantidad de números de rifa:</label>
                <input type="number" id="cantidad-numeros" name="cantidad-numeros" min="1" value="10" required>
        
                <label for="precio-boleto">Precio por boleto:</label>
                <input type="number" id="precio-boleto" name="precio-boleto" min="0" step="0.01" value="1.00" required>
        
                <div id="metodos-pago-container">
                    <div class="metodo-pago">
                        <label for="metodo-pago-1">Método de pago 1:</label>
                        <input type="text" id="metodo-pago-1" name="metodo-pago-1" required>
                        <button type="button" class="eliminar-metodo-pago">Eliminar</button>
                    </div>
                </div>
        
                <button type="button" id="agregar-metodo-pago">Agregar Método de Pago</button>
                <button type="submit">Guardar Configuración</button>
            </form>
        </section>
        
        

<script>
// Simulación de base de datos de boletos (en este caso, un arreglo simple)
const boletosDisponibles = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];

// Variables para almacenar datos de ventas
let ventas = [];

// Inicializar la interfaz al cargar la página
window.onload = function() {
    cargarBoletosDisponibles();
    configurarFormularioCompra();
    actualizarReporteVentas();
};

// Función para cargar los boletos disponibles en la interfaz
function cargarBoletosDisponibles() {
    const listaBoletos = document.getElementById('lista-boletos');
    const selectBoleto = document.getElementById('boleto');
    const selectMetodoPago = document.getElementById('metodo-pago');

    listaBoletos.innerHTML = ''; // Limpiar lista antes de agregar nuevos boletos
    selectBoleto.innerHTML = ''; // Limpiar opciones del select antes de agregar nuevas
    selectMetodoPago.innerHTML = ''; // Limpiar opciones del select de método de pago

    boletosDisponibles.forEach(boleto => {
        const elementoBoleto = document.createElement('div');
        elementoBoleto.classList.add('boleto');
        elementoBoleto.textContent = boleto;
        listaBoletos.appendChild(elementoBoleto);

        const optionBoleto = document.createElement('option');
        optionBoleto.value = boleto;
        optionBoleto.textContent = boleto;
        selectBoleto.appendChild(optionBoleto);
    });

    // Agregar opciones de método de pago
    metodosPago.forEach((metodo, index) => {
        const optionMetodoPago = document.createElement('option');
        optionMetodoPago.value = metodo;
        optionMetodoPago.textContent = metodo;
        selectMetodoPago.appendChild(optionMetodoPago);
    });
}


// Función para configurar el formulario de compra
function configurarFormularioCompra() {
    const formularioCompra = document.getElementById('formulario-compra');
    formularioCompra.addEventListener('submit', function(event) {
        event.preventDefault(); // Evitar la recarga de la página

        const nombre = document.getElementById('nombre').value;
        const boleto = parseInt(document.getElementById('boleto').value);
        const metodoPago = document.getElementById('metodo-pago').value;

        // Validar datos del formulario
        if (!nombre || isNaN(boleto) || !metodoPago) {
            alert('Por favor, complete todos los campos del formulario.');
            return;
        }

        // Verificar si el boleto está disponible
        if (!boletosDisponibles.includes(boleto)) {
            alert('El boleto seleccionado no está disponible.');
            return;
        }

        // Registrar la venta
        const venta = {
            nombre: nombre,
            boleto: boleto,
            metodoPago: metodoPago,
            fecha: new Date()
        };
        ventas.push(venta);

        // Actualizar la interfaz
        actualizarBoletosDisponibles(boleto);
        actualizarReporteVentas();

        // Limpiar el formulario
        formularioCompra.reset();

        // Alertar al usuario de la compra exitosa
        alert('¡Compra realizada con éxito!');
    });
}

// Función para actualizar la lista de boletos disponibles
function actualizarBoletosDisponibles(boletoVendido) {
    const indiceBoleto = boletosDisponibles.indexOf(boletoVendido);
    if (indiceBoleto !== -1) {
        boletosDisponibles.splice(indiceBoleto, 1);
        cargarBoletosDisponibles();
    }
}

// Función para actualizar el reporte de ventas
function actualizarReporteVentas() {
    const reporteVentas = document.querySelector('.reporte .ventas-dia');
    reporteVentas.innerHTML = ''; // Limpiar reporte antes de agregar nuevos datos

    const totalPorMetodoPago = {}; // Objeto para almacenar el total por cada método de pago

    ventas.forEach(venta => {
        const elementoVenta = document.createElement('div');
        elementoVenta.classList.add('venta');
        elementoVenta.innerHTML = `
            <span>${venta.nombre} - ${venta.boleto}</span>
            <span>${venta.metodoPago}</span>
            <span>${venta.fecha.toLocaleDateString()}</span>
        `;
        reporteVentas.appendChild(elementoVenta);

        // Incrementar el total por cada método de pago
        if (!totalPorMetodoPago[venta.metodoPago]) {
            totalPorMetodoPago[venta.metodoPago] = 0;
        }
        totalPorMetodoPago[venta.metodoPago] += precioPorBoleto;
    });

    // Mostrar el total por cada método de pago en el reporte
    for (const metodoPago in totalPorMetodoPago) {
        const elementoTotalMetodoPago = document.createElement('div');
        elementoTotalMetodoPago.textContent = `Total vendido (${metodoPago}): $${totalPorMetodoPago[metodoPago].toFixed(2)}`;
        reporteVentas.appendChild(elementoTotalMetodoPago);
    }
}






// Función para configurar la cantidad de números y el precio por boleto
function configurarRifas(event) {
    event.preventDefault(); // Evitar la recarga de la página

    const cantidadNumeros = parseInt(document.getElementById('cantidad-numeros').value);
    const precioBoleto = parseFloat(document.getElementById('precio-boleto').value);
    const metodosPagoInputs = document.querySelectorAll('[id^="metodo-pago-"]');

    // Validar datos
    if (cantidadNumeros <= 0 || precioBoleto <= 0) {
        alert('Por favor, ingrese valores válidos para la cantidad de números y el precio por boleto.');
        return;
    }

    // Actualizar la configuración
    boletosDisponibles.length = 0; // Vaciar el array
    for (let i = 1; i <= cantidadNumeros; i++) {
        boletosDisponibles.push(i);
    }

    // Actualizar precio de boleto
    precioPorBoleto = precioBoleto;

    // Actualizar métodos de pago
    metodosPago = [];
    metodosPagoInputs.forEach(input => {
        if (input.value.trim() !== '') {
            metodosPago.push(input.value.trim());
        }
    });

    // Actualizar la interfaz
    cargarBoletosDisponibles();
}

// Agregar evento al botón "agregar-metodo-pago"
document.getElementById('agregar-metodo-pago').addEventListener('click', function() {
    const container = document.getElementById('metodos-pago-container');
    const numMetodosPago = container.querySelectorAll('.metodo-pago').length + 1;

    const nuevoMetodoPago = document.createElement('div');
    nuevoMetodoPago.classList.add('metodo-pago');
    nuevoMetodoPago.innerHTML = `
        <label for="metodo-pago-${numMetodosPago}">Método de pago ${numMetodosPago}:</label>
        <input type="text" id="metodo-pago-${numMetodosPago}" name="metodo-pago-${numMetodosPago}" required>
        <button type="button" class="eliminar-metodo-pago">Eliminar</button>
    `;

    container.appendChild(nuevoMetodoPago);
});

// Agregar evento delegado a los botones "eliminar-metodo-pago"
document.getElementById('metodos-pago-container').addEventListener('click', function(event) {
    if (event.target.classList.contains('eliminar-metodo-pago')) {
        event.target.parentNode.remove();
    }
});


// Escuchar el envío del formulario de configuración
const formularioConfiguracion = document.getElementById('formulario-configuracion');
formularioConfiguracion.addEventListener('submit', configurarRifas);

</script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</body>
</html>
